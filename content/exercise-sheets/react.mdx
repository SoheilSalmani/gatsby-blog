---
title: React
relatedResources:
  - "9781838645564"
tags: []
---

## React in Action

1. Suppose you have a `Post` component which takes the following props: `user`,
   `content` and `id`. How to validate these props using `PropTypes` to ensure
   that `user` and `content` are a string values, and `id` a number? Also, how
   to ensure that all props are given?

   <Solution>

   ```shell
   npm i prop-types
   ```

   ```jsx
   Post.propTypes = {
     user: PropTypes.string.isRequired,
     content: PropTypes.string.isRequired,
     id: PropTypes.number.isRequired,
   }
   ```

   </Solution>

## React Hooks in Action

## React Docs: Intro to React

## The React Workshop

1. Get help for Create React App via `npx`. Print the intalled version of Create
   React App.

   <Solution>

   ```shell
   npx create-react-app --help
   npx create-react-app --version
   ```

   </Solution>

2. Test different flags in the Create React App CLI.

   <Solution>

   Some flags: `--verbose`, `--info`,`--scripts-version`, `--use-npm`,
   `--use-pnp` (default `yarn`), `--typescript`.

   </Solution>

3. Create a project called `hello-react` with Create React App.

   <Solution>

   ```shell
   npx create-react-app hello-react
   ```

   </Solution>

4. Create a new component which is a `div` element. Give it a CSS class named
   `greeting`. Give the `div` element a black background and white text. Next,
   fill the body with the text of `Hello World`. Finally, display a `hello`
   alert when the `div` is clicked on.

   <Solution>

   ```jsx nu fp=src/App.js
   import React from "react"

   const App = () => (
     <div
       className="greeting"
       style={{ background: "black", color: "white" }}
       onClick={() => alert("hello")}
     >
       Hello World
     </div>
   )

   export default App
   ```

   </Solution>

5. Using a class component, build a form which prints something in the console
   when submitting. Add form validation and use constructor bind statements for
   event handlers.

   <Solution>

   ```jsx nu
   import React, { Component } from "react"

   class App extends Component {
     constructor(props) {
       super(props)
       this.state = {
         username: "",
         password: "",
         passwordConfirmation: "",
         email: "",
         errors: [],
       }
       this.validateUsernameOnBlur = this.validateUsernameOnBlur.bind(this)
       this.validatePasswordOnBlur = this.validatePasswordOnBlur.bind(this)
       this.validatePasswordConfirmationOnBlur =
         this.validatePasswordConfirmationOnBlur.bind(this)
       this.validateEmailOnBlur = this.validateEmailOnBlur.bind(this)
     }
     displayForm() {
       return (
         <div>
           <p>
             <label>
               Username:{" "}
               <input type="text" onBlur={this.validateUsernameOnBlur} />
             </label>
           </p>
           <p>
             <label>
               Password:{" "}
               <input type="password" onBlur={this.validatePasswordOnBlur} />
             </label>
           </p>
           <p>
             <label>
               Password Confirmation:{" "}
               <input
                 type="password"
                 onBlur={this.validatePasswordConfirmationOnBlur}
               />
             </label>
           </p>
           <p>
             <label>
               Email: <input type="text" onBlur={this.validateEmailOnBlur} />
             </label>
           </p>
           <p>
             <button onClick={this.submitForm}>Submit</button>
           </p>
         </div>
       )
     }
     displayErrors() {
       return (
         <div className="errors">
           {this.state.errors.map((err, i) => (
             <p key={`err-${i}`}>{err}</p>
           ))}
         </div>
       )
     }
     validateNotEmpty(fieldName, value) {
       if (value.length <= 0) {
         return `${fieldName} must be filled out!`
       }
     }
     validateUsernameOnBlur(event) {
       const username = event.target.value
       const errors = this.state.errors
       errors.push(this.validateNotEmpty("Username", username))
       this.setState({ username, errors })
     }
     validatePasswordOnBlur(event) {
       const password = event.target.value
       const errors = this.state.errors
       errors.push(this.validateNotEmpty("Password", password))
       this.setState({ password, errors })
     }
     validateEmailOnBlur(event) {
       const email = event.target.value
       const errors = this.state.errors
       errors.push(this.validateEmailFormat("Email", email))
       this.setState({ email, errors })
     }
     validateEmailFormat(fieldName, value) {
       let [lhs, rhs] = value.split("@")
       lhs = lhs || ""
       rhs = rhs || ""
       if (lhs.length <= 0 || rhs.length <= 0) {
         return `${fieldName} must be in a standard email format!`
       }
     }
     validatePasswordConfirmationOnBlur(event) {
       const passwordConfirmation = event.target.value
       const errors = this.state.errors
       if (passwordConfirmation !== this.state.password) {
         errors.push("Password must match password confirmation!")
       }
       this.setState({ passwordConfirmation, errors })
     }
     submitForm(event) {
       event.preventDefault()
       console.log("Submitting the form now...")
       console.log(event)
     }
     render() {
       return (
         <div className="App">
           <h1>Create Account</h1>
           {this.displayErrors()}
           <hr />
           {this.displayForm()}
         </div>
       )
     }
   }

   export default App
   ```

   </Solution>

6. Transform the preceding code to use in-line bind statements.

   <Solution>

   ```jsx nu hl=22,31,40,49
   import React, { Component } from "react"

   class App extends Component {
     constructor(props) {
       super(props)
       this.state = {
         username: "",
         password: "",
         passwordConfirmation: "",
         email: "",
         errors: [],
       }
     }
     displayForm() {
       return (
         <div>
           <p>
             <label>
               Username:{" "}
               <input
                 type="text"
                 onBlur={this.validateUsernameOnBlur.bind(this)}
               />
             </label>
           </p>
           <p>
             <label>
               Password:{" "}
               <input
                 type="password"
                 onBlur={this.validatePasswordOnBlur.bind(this)}
               />
             </label>
           </p>
           <p>
             <label>
               Password Confirmation:{" "}
               <input
                 type="password"
                 onBlur={this.validatePasswordConfirmationOnBlur.bind(this)}
               />
             </label>
           </p>
           <p>
             <label>
               Email:{" "}
               <input
                 type="text"
                 onBlur={this.validateEmailOnBlur.bind(this)}
               />
             </label>
           </p>
           <p>
             <button onClick={this.submitForm}>Submit</button>
           </p>
         </div>
       )
     }
     displayErrors() {
       return (
         <div className="errors">
           {this.state.errors.map((err, i) => (
             <p key={`err-${i}`}>{err}</p>
           ))}
         </div>
       )
     }
     validateNotEmpty(fieldName, value) {
       if (value.length <= 0) {
         return `${fieldName} must be filled out!`
       }
     }
     validateUsernameOnBlur(event) {
       const username = event.target.value
       const errors = this.state.errors
       errors.push(this.validateNotEmpty("Username", username))
       this.setState({ username, errors })
     }
     validatePasswordOnBlur(event) {
       const password = event.target.value
       const errors = this.state.errors
       errors.push(this.validateNotEmpty("Password", password))
       this.setState({ password, errors })
     }
     validateEmailOnBlur(event) {
       const email = event.target.value
       const errors = this.state.errors
       errors.push(this.validateEmailFormat("Email", email))
       this.setState({ email, errors })
     }
     validateEmailFormat(fieldName, value) {
       let [lhs, rhs] = value.split("@")
       lhs = lhs || ""
       rhs = rhs || ""
       if (lhs.length <= 0 || rhs.length <= 0) {
         return `${fieldName} must be in a standard email format!`
       }
     }
     validatePasswordConfirmationOnBlur(event) {
       const passwordConfirmation = event.target.value
       const errors = this.state.errors
       if (passwordConfirmation !== this.state.password) {
         errors.push("Password must match password confirmation!")
       }
       this.setState({ passwordConfirmation, errors })
     }
     submitForm(event) {
       event.preventDefault()
       console.log("Submitting the form now...")
       console.log(event)
     }
     render() {
       return (
         <div className="App">
           <h1>Create Account</h1>
           {this.displayErrors()}
           <hr />
           {this.displayForm()}
         </div>
       )
     }
   }

   export default App
   ```

   </Solution>

7. Transform the preceding code to not use any bind statements. Do not use a
   constructor in this version.

   <Solution>

   ```jsx nu hl=4..10,60,66,72,86
   import React, { Component } from "react"

   class App extends Component {
     state = {
       username: "",
       password: "",
       passwordConfirmation: "",
       email: "",
       errors: [],
     }
     displayForm() {
       return (
         <div>
           <p>
             <label>
               Username:{" "}
               <input type="text" onBlur={this.validateUsernameOnBlur} />
             </label>
           </p>
           <p>
             <label>
               Password:{" "}
               <input type="password" onBlur={this.validatePasswordOnBlur} />
             </label>
           </p>
           <p>
             <label>
               Password Confirmation:{" "}
               <input
                 type="password"
                 onBlur={this.validatePasswordConfirmationOnBlur}
               />
             </label>
           </p>
           <p>
             <label>
               Email: <input type="text" onBlur={this.validateEmailOnBlur} />
             </label>
           </p>
           <p>
             <button onClick={this.submitForm}>Submit</button>
           </p>
         </div>
       )
     }
     displayErrors() {
       return (
         <div className="errors">
           {this.state.errors.map((err, i) => (
             <p key={`err-${i}`}>{err}</p>
           ))}
         </div>
       )
     }
     validateNotEmpty(fieldName, value) {
       if (value.length <= 0) {
         return `${fieldName} must be filled out!`
       }
     }
     validateUsernameOnBlur = event => {
       const username = event.target.value
       const errors = this.state.errors
       errors.push(this.validateNotEmpty("Username", username))
       this.setState({ username, errors })
     }
     validatePasswordOnBlur = event => {
       const password = event.target.value
       const errors = this.state.errors
       errors.push(this.validateNotEmpty("Password", password))
       this.setState({ password, errors })
     }
     validateEmailOnBlur = event => {
       const email = event.target.value
       const errors = this.state.errors
       errors.push(this.validateEmailFormat("Email", email))
       this.setState({ email, errors })
     }
     validateEmailFormat(fieldName, value) {
       let [lhs, rhs] = value.split("@")
       lhs = lhs || ""
       rhs = rhs || ""
       if (lhs.length <= 0 || rhs.length <= 0) {
         return `${fieldName} must be in a standard email format!`
       }
     }
     validatePasswordConfirmationOnBlur = event => {
       const passwordConfirmation = event.target.value
       const errors = this.state.errors
       if (passwordConfirmation !== this.state.password) {
         errors.push("Password must match password confirmation!")
       }
       this.setState({ passwordConfirmation, errors })
     }
     submitForm(event) {
       event.preventDefault()
       console.log("Submitting the form now...")
       console.log(event)
     }
     render() {
       return (
         <div className="App">
           <h1>Create Account</h1>
           {this.displayErrors()}
           <hr />
           {this.displayForm()}
         </div>
       )
     }
   }

   export default App
   ```

   </Solution>

8. Build a form which allows to write a blog post. Print the number of
   characters, and disable the submit button if the post is not longer than 100
   characters.

   <Solution>

   ```jsx nu
   import React, { Component } from "react"

   class App extends Component {
     constructor(props) {
       super(props)
       this.state = { field: "", submitDisabled: true }
     }
     renderFieldLength() {
       return <p>{`${this.state.field.length} character(s)!`}</p>
     }
     updateFieldLength(event) {
       const field = event.target.value
       this.setState({ field }, () => {
         this.validateFieldLength()
       })
     }
     validateFieldLength() {
       if (this.state.submitDisabled && this.state.field.length > 100) {
         this.setState({ submitDisabled: false })
       } else if (
         !this.state.submitDisabled &&
         this.state.field.length <= 100
       ) {
         this.setState({ submitDisabled: true })
       }
     }
     submitForm(event) {
       event.preventDefault()
       alert("Submitting the blog post!")
     }
     render() {
       return (
         <div className="App">
           <h1>Blog Post Writer</h1>
           <hr />
           <form>
             <label>
               <h2>Write your post here</h2>
               <p>Must be at least 100 characters!</p>
               <textarea
                 cols="80"
                 rows="25"
                 onChange={this.updateFieldLength.bind(this)}
               ></textarea>
             </label>
             {this.renderFieldLength()}
             <button
               disabled={this.state.submitDisabled}
               onClick={this.submitForm}
             >
               Submit Post
             </button>
           </form>
         </div>
       )
     }
   }

   export default App
   ```

   </Solution>

9. Build an app which display a button. The button should show and hide a secret
   message.

   <Solution>

   ```jsx nu fp=src/App.js
   import React, { Component } from "react"

   class App extends Component {
     constructor(props) {
       super(props)
       this.state = {
         showSecret: false,
       }
     }
     secretMessage() {
       if (!this.state.showSecret) {
         return
       }
       return <div className="secret-message">I am the secret message!</div>
     }
     toggleSecretMessage() {
       this.setState({
         showSecret: !this.state.showSecret,
       })
     }
     render() {
       return (
         <div className="App">
           <button onClick={this.toggleSecretMessage.bind(this)}>
             Click to {this.state.showSecret ? "hide" : "show"} show the secret
             message!
           </button>
           {this.secretMessage()}
         </div>
       )
     }
   }

   export default App
   ```

   </Solution>

10. Build a simple quiz app.

   <Solution>
   
   ```jsx nu fp=src/App.js
   import React, { Component } from "react"
   import "./App.css"
   
   class App extends Component {
     constructor(props) {
       super(props)
       this.state = {
         playerScore: 0,
         questions: [
           {
             question: "What animal barks?",
             possibleAnswers: ["Dog", "Cat"],
             rightAnswer: "Dog",
             playerChoice: null,
           },
           {
             question: "What animal is more closely related to a tiger?",
             possibleAnswers: ["Dog", "Cat"],
             rightAnswer: "Cat",
             playerChoice: null,
           },
           {
             question: "What animal is more closely related to a wolf?",
             possibleAnswers: ["Dog", "Cat"],
             rightAnswer: "Dog",
             playerChoice: null,
           },
           {
             question: "What animal is best known for playing fetch?",
             possibleAnswers: ["Dog", "Cat"],
             rightAnswer: "Dog",
             playerChoice: null,
           },
         ],
       }
       this.answerQuestion = this.answerQuestion.bind(this)
     }
     answerQuestion(index, choice) {
       const answeredQuestion = this.state.questions[index]
       answeredQuestion.playerChoice = choice
       const allQuestions = this.state.questions
       allQuestions[index] = answeredQuestion
       this.setState(
         {
           questions: allQuestions,
         },
         () => {
           this.updatePlayerScore()
         }
       )
     }
     updatePlayerScore() {
       const playerScore = this.state.questions.filter(
         q => q.rightAnswer === q.playerChoice
       ).length
       this.setState({ playerScore })
       console.log("New player score:", playerScore)
     }
     displayResult(index) {
       const question = this.state.questions[index]
       if (!question.playerChoice) {
         return
       }
       if (question.playerChoice === question.rightAnswer) {
         return <p className="result-correct">Your answer is correct!</p>
       } else {
         return <p className="result-incorrect">Your answer is incorrect!</p>
       }
     }
     displayQuestion(index) {
       if (this.state.playerScore < index) {
         return
       }
       const question = this.state.questions[index]
       return (
         <div className="question-display">
           <p className="question">{question.question}</p>
           {question.possibleAnswers.map((answer, answerIndex) => (
             <button
               key={`q-${index}-a-${answerIndex}`}
               className="question-choice"
               onClick={() => this.answerQuestion(index, answer)}
             >
               {answer}
             </button>
           ))}
           {this.displayResult(index)}
         </div>
       )
     }
     renderQuestions() {
       return this.state.questions.map((question, index) =>
         this.displayQuestion(index)
       )
     }
     render() {
       return (
         <div className="App">
           <h1>Quiz Show!</h1>
           <hr />
           {this.renderQuestions()}
         </div>
       )
     }
   }
   
   export default App
   ```
   
   
   ```css nu fp=src/App.css
   .question-display {
     background: #ddd;
     border: 2px solid #ccc;
     margin: 20px;
     padding: 10px;
   }
   
   .question {
     font-weight: bold;
   }
   
   .question-choice {
     height: 5em;
     width: 20em;
     margin: 10px;
   }
   
   .result-correct {
     color: #272;
   }
   
   .result-incorrect {
     color: #922;
   }
   ```
   
   </Solution>
   
11. Build a memory game.

   <Solution>
   
   ```jsx nu fp=src/App.js
   import React, { Component } from "react"
   import "./App.css"
   
   const TILE_COUNT = 24
   
   class App extends Component {
     constructor(props) {
       super(props)
       this.state = {
         tiles: [],
         lastFlipped: null,
         clicks: 0,
       }
       this.resetTiles = this.resetTiles.bind(this)
       this.flipTile = this.flipTile.bind(this)
     }
     flipAllBackOver(tiles) {
       tiles.forEach(tile => {
         if (!tile.matched) {
           tile.flipped = true
         }
       })
       return tiles
     }
     flipTile(index) {
       let tiles = this.state.tiles
       let tile = tiles[index]
       let clicks = this.state.clicks + 1
       let lastFlipped = this.state.lastFlipped
       if (lastFlipped === null) {
         tiles = this.flipAllBackOver(tiles)
         tile.flipped = !tile.flipped
         lastFlipped = index
       } else {
         tile.flipped = !tile.flipped
         let lastFlippedTile = this.state.tiles[lastFlipped]
         if (lastFlippedTile.number === tile.number) {
           lastFlippedTile.matched = true
           tile.matched = true
           tiles[lastFlipped] = lastFlippedTile
         }
         lastFlipped = null
       }
       tiles[index] = tile
       this.setState({ clicks, tiles, lastFlipped })
     }
     resetTiles() {
       let tiles = []
       let number = 0
       for (let i = 0; i < TILE_COUNT; i += 2) {
         number++
         let tileOne = { flipped: true, matched: false, number }
         let tileTwo = { flipped: true, matched: false, number }
         tiles = [...tiles, tileOne, tileTwo]
       }
       for (let i = 0; i < tiles.length; i++) {
         const swapWith = Math.floor(Math.random() * tiles.length)
         ;[tiles[i], tiles[swapWith]] = [tiles[swapWith], tiles[i]]
       }
       this.setState({ clicks: 0, tiles })
     }
     renderTile(tile, index) {
       let classes = ["Tile"]
       if (tile.flipped) {
         classes = [...classes, "flipped"]
       }
       if (tile.matched) {
         classes = [...classes, "matched"]
       }
       let key = `tile-${index}`
       return (
         <div
           key={key}
           className={classes.join(" ")}
           onClick={() => this.flipTile(index)}
         >
           {!tile.flipped && tile.number}
         </div>
       )
     }
     render() {
       return (
         <div className="App">
           <h1>Memory Game</h1>
           <strong>Clicks: {this.state.clicks}</strong>
           <br />
           <button onClick={this.resetTiles} className="reset">
             New Game
           </button>
           <hr />
           {this.state.tiles.map((tile, index) => this.renderTile(tile, index))}
         </div>
       )
     }
   }
   
   export default App
   ```
   
   ```css nu fp=src/App.css
   .Tile {
     width: 200px;
     height: 200px;
     font-size: 64pt;
     border: 2px solid #aaa;
     text-align: center;
     margin: 10px;
     padding: 10px;
     float: left;
     cursor: pointer;
   }
   
   .Tile:hover {
     border: 2px solid #f00;
   }
   
   .Tile.flipped {
     background: #aaa;
   }
   
   .Tile.matched {
     border: 2px solid #040;
     background: #afa;
   }
   
   button.reset {
     padding: 10px;
     width: 200px;
   }
   ```
   
   </Solution>

12. Write a component which log a message at the most important steps in its
    lifecycle.

    <Solution>

    ```jsx nu
    import React, { Component } from "react"

    class App extends Component {
      constructor(props) {
        super(props)
        console.log("Constructor")
        this.state = { cycle: 0 }
        setInterval(() => this.setState({ cycle: this.state.cycle + 1 }), 1000)
      }
      componentDidMount() {
        console.log("Component Did Mount")
      }
      componentDidUpdate() {
        console.log("Component Did Update")
      }
      render() {
        console.log("Render")
        return (
          <div className="App">Hello Lifecycle: Cycle {this.state.cycle}</div>
        )
      }
    }

    export default App
    ```

    </Solution>

13. Write an app which render conditionally a component. Log the most important
    steps of the mount lifecycle of the conditionally rendered component.

    <Solution>

    ```jsx nu
    import React, { Component } from "react"

    class App extends Component {
      constructor(props) {
        super(props)
        console.log("Constructor")
        this.state = { cycle: 0 }
        setInterval(() => this.setState({ cycle: this.state.cycle + 1 }), 1000)
      }
      componentDidMount() {
        console.log("Component Did Mount")
      }
      componentDidUpdate() {
        console.log("Component Did Update")
      }
      render() {
        console.log("Render")
        return (
          <div className="App">Hello Lifecycle: Cycle {this.state.cycle}</div>
        )
      }
    }

    export default App
    ```

    </Solution>

14. Write an app which render conditionally a component. Log the most important
    steps of the mount lifecycle of the conditionally rendered component.

    <Solution>

    ```jsx nu fp=App.js
    import React, { Component } from "react"
    import LifecycleTest from "./LifecycleTest"

    class App extends Component {
      render() {
        return (
          <div className="App">
            Hello Conditional
            {true && <LifecycleTest />}
          </div>
        )
      }
    }

    export default App
    ```

    ```jsx nu fp=LifecycleTest.js
    import React, { Component } from "react"

    class LifecycleTest extends Component {
      constructor(props) {
        super(props)
        console.log("LifecycleTest Constructor")
      }
      render() {
        return <p>I only show up if the conditional is true!</p>
      }
    }

    export default LifecycleTest
    ```

    </Solution>

15. Using component lifecycle methods, write a app which simulate the load of
    user messages.

    <Solution>

    ```jsx nu
    import React, { Component } from "react"

    class App extends Component {
      constructor(props) {
        super(props)
        // State will be messages: ["Hello World", "How are you"]
        this.state = { messages: [], loading: true }
      }
      componentDidUpdate(prevProps, prevState) {
        console.log("prevProps:", prevProps)
        console.log("prevState:", prevState)
      }
      componentDidMount() {
        setTimeout(
          () =>
            this.setState({
              messages: ["Hello World", "How are you?"],
              loading: false,
            }),
          10000 // 10 seconds
        )
      }
      componentWillUnmount() {
        alert("I've been removed!")
      }
      renderProfile() {
        if (this.state.loading) {
          return <div>Loading...</div>
        }
        if (this.state.messages && this.state.messages.length > 0) {
          return (
            <div>
              <ul>
                {this.state.messages.map((msg, index) => (
                  <li key={`msg-${index}`}>{msg}</li>
                ))}
              </ul>
            </div>
          )
        } else {
          return <div>No messages!</div>
        }
      }
      render() {
        return (
          <div className="App">
            User Profile
            <hr />
            {this.renderProfile()}
          </div>
        )
      }
    }

    export default App
    ```

    </Solution>

16. Same but add the possibility to remove messages.

    <Solution>

    ```jsx nu fp=App.js
    import React, { Component } from "react"
    import Message from "./Message"

    class App extends Component {
      constructor(props) {
        super(props)
        this.state = {
          list: [
            { id: 1, message: "Hello" },
            { id: 2, message: "Everyone" },
            { id: 3, message: "What" },
            { id: 4, message: "Is" },
            { id: 5, message: "Up" },
          ],
        }
      }
      removeItem(id) {
        const newList = this.state.list.filter(item => item.id !== id)
        this.setState({ list: newList })
      }
      render() {
        return (
          <div className="App">
            <h1>My Items</h1>
            {this.state.list.map(item => (
              <Message
                key={item.id}
                id={item.id}
                message={item.message}
                removeItem={this.removeItem.bind(this)}
              />
            ))}
          </div>
        )
      }
    }

    export default App
    ```

    ```jsx nu fp=Message.js
    import React, { Component } from "react"

    class Message extends Component {
      componentWillUnmount() {
        console.log("Removing item", this.props)
      }
      render() {
        return (
          <div className="Message">
            <p>{this.props.message}</p>
            <button onClick={() => this.props.removeItem(this.props.id)}>
              Remove me
            </button>
          </div>
        )
      }
    }

    export default Message
    ```

    </Solution>

17. Build a new app which simulate AJAX calls. The app should contain a user
    login form, a user counter, a component indicating which user is logged, and
    the user's messages.

    <Solution>

    ```js nu fp=AjaxLibrary.js
    const SLEEP_FOR = 5000
    const users = {
      testA: {
        id: 1,
        username: "testA",
      },
      testB: {
        id: 2,
        username: "testB",
      },
    }
    const messages = {
      1: ["Hello testA", "How are you doing today?"],
      2: [],
    }

    function sleep(time) {
      return new Promise(res => setTimeout(res, time))
    }

    const fetchUserCount = async () => {
      await sleep(SLEEP_FOR)
      return Object.keys(users).length
    }

    const fetchUser = async username => {
      await sleep(SLEEP_FOR)
      return users[username]
    }

    const fetchMessages = async userId => {
      await sleep(SLEEP_FOR)
      return messages[userId]
    }

    export { fetchUserCount, fetchUser, fetchMessages }
    ```

    ```jsx nu fp=App.js
    import React, { Component } from "react"
    import UserCountDisplay from "./UserCountDisplay"
    import LoginDisplay from "./LoginDisplay"

    class App extends Component {
      render() {
        return (
          <div className="App">
            <h1>Messaging App</h1>
            <UserCountDisplay />
            <LoginDisplay />
          </div>
        )
      }
    }

    export default App
    ```

    ```jsx nu fp=UserCountDisplay.js
    import React, { Component } from "react"
    import { fetchUserCount } from "./AjaxLibrary"

    class UserCountDisplay extends Component {
      constructor(props) {
        super(props)
        this.state = { userCount: 0, loadingUserCount: false }
      }
      async componentDidMount() {
        this.setState({ loadingUserCount: true })
        const userCount = await fetchUserCount()
        this.setState({ userCount, loadingUserCount: false })
      }
      render() {
        if (this.state.loadingUserCount) {
          return <p>Loading user count...</p>
        } else {
          return <p>Users in the app: {this.state.userCount}</p>
        }
      }
    }

    export default UserCountDisplay
    ```

    ```js nu fp=LoginDisplay.js
    import React, { Component } from "react"
    import { fetchUser } from "./AjaxLibrary"
    import UserDisplay from "./UserDisplay"

    class LoginDisplay extends Component {
      constructor(props) {
        super(props)
        this.state = { loginUsername: null, loadingLogin: false, user: null }
        this.updateLoginForm = this.updateLoginForm.bind(this)
        this.doLogin = this.doLogin.bind(this)
        this.doLogout = this.doLogout.bind(this)
      }
      updateLoginForm(evt) {
        const loginUsername = evt.target.value
        this.setState({ loginUsername })
      }
      async doLogin() {
        this.setState({ loadingLogin: true })
        const user = await fetchUser(this.state.loginUsername)
        this.setState({ user, loadingLogin: false })
      }
      doLogout() {
        this.setState({ user: null })
      }
      loginForm() {
        if (this.state.loadingLogin) {
          return "Trying to login, please wait..."
        } else {
          if (!this.state.user) {
            return (
              <div className="Login">
                Login Username:
                <input type="text" onChange={this.updateLoginForm} />
                <button onClick={this.doLogin}>Login</button>
              </div>
            )
          } else {
            return <button onClick={this.doLogout}>Logout</button>
          }
        }
      }
      render() {
        return (
          <div className="LoginDisplay">
            {this.loginForm()}
            <hr />
            <UserDisplay user={this.state.user} />
          </div>
        )
      }
    }

    export default LoginDisplay
    ```

    ```jsx nu fp=UserDisplay.js
    import React, { Component } from "react"
    import MessageDisplay from "./MessageDisplay"

    class UserDisplay extends Component {
      render() {
        if (!this.props.user) {
          return null
        }
        return (
          <div className="UserDisplay">
            Logged in as {this.props.user.username}!
            <MessageDisplay userId={this.props.user.id} />
          </div>
        )
      }
    }

    export default UserDisplay
    ```

    ```jsx nu fp=MessageDisplay.js
    import React, { Component } from "react"
    import { fetchMessages } from "./AjaxLibrary"

    class MessageDisplay extends Component {
      constructor(props) {
        super(props)
        this.state = { loadingMessages: false, messages: [] }
      }
      async componentDidMount() {
        this.setState({ loadingMessages: true })
        const messages = await fetchMessages(this.props.userId)
        this.setState({ messages, loadingMessages: false })
      }
      componentWillUnmount() {
        console.log("Unmounting messages")
      }
      render() {
        if (this.state.loadingMessages) {
          return <p>Messages still loading...</p>
        } else {
          if (this.state.messages.length > 0) {
            return (
              <ul>
                {this.state.messages.map((msg, index) => (
                  <li key={`m-${index}`}>{msg}</li>
                ))}
              </ul>
            )
          } else {
            return <p>No messages for you!</p>
          }
        }
      }
    }

    export default MessageDisplay
    ```

    </Solution>

18. Build the following React application:

    <Figure src="/media/react-modal-component-exercise.jpg">
      React Application with a modal component.
    </Figure>

    <Solution>

    ```jsx nu fp=src/App.js
    import React, { Component } from "react"
    import "./App.css"
    import { Modal } from "./components/Modal"

    class App extends Component {
      constructor(props) {
        super(props)
        this.state = {
          showModal: false,
        }
        this.toggleModal = this.toggleModal.bind(this)
      }
      toggleModal() {
        this.setState({
          showModal: !this.state.showModal,
        })
      }
      render() {
        return (
          <div className="container">
            <div>
              <p>
                Crema caffeine, single origin variety coffee a qui turkish.
                Wings strong siphon extra percolator sweet single origin
                percolator. Redeye aftertaste strong single shot organic redeye
                brewed kopi-luwak caffeine variety. Aftertaste, arabica crema to
                go trifecta that grinder.
              </p>
              <p>
                Flavour saucer, con panna sit wings macchiato dripper sugar qui
                lungo turkish dripper. Acerbic blue mountain milk ristretto
                crema, rich barista ut and cappuccino filter. Saucer dark
                cappuccino, froth, extraction coffee crema white half and half
                single shot to go. Flavour cup robust cream eu café au lait
                extraction con panna trifecta body blue mountain decaffeinated.
              </p>
              <p>
                Eu shop, mocha body cortado pumpkin spice galão. Java affogato
                ristretto, dark flavour qui est white grounds a black. Cultivar
                siphon flavour, extra organic grinder kopi-luwak acerbic java
                organic. To go, et trifecta irish percolator cream est ut single
                origin mocha.
              </p>
              <p>
                Qui beans, caffeine skinny bar seasonal mazagran. Turkish spoon
                beans rich arabica medium kopi-luwak turkish. A, con panna blue
                mountain aftertaste steamed, so irish crema caffeine rich.
                Aftertaste eu aftertaste foam, con panna and rich robust and
                aroma arabica.
              </p>
            </div>
            <button onClick={this.toggleModal}>Show Modal</button>
            <Modal
              showModal={this.state.showModal}
              toggleModal={this.toggleModal}
            >
              Text in overlay
            </Modal>
          </div>
        )
      }
    }

    export default App
    ```

    ```css nu fp=src/App.css
    .container {
      max-width: 960px;
      margin: 0 auto;
      padding: 0 10%;
    }

    button {
      margin-top: 2rem;
      border: solid 1px #999;
      padding: 0.5rem 1rem;
      cursor: pointer;
    }
    ```

    ```jsx nu fp=src/components/Modal/index.js
    import React, { Component } from "react"
    import "./styles.css"

    class Modal extends Component {
      render() {
        if (!this.props.showModal) {
          return null
        }
        return (
          <div className="modal">
            <div className="modal_content">
              {this.props.children}
              <div>
                <button onClick={this.props.toggleModal}>Close</button>
              </div>
            </div>
          </div>
        )
      }
    }

    export { Modal }
    ```

    ```css nu fp=src/components/Modal/styles.css
    .modal {
      background: rgba(0, 0, 0, 0.3);
      position: fixed;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
      padding: 30px;
    }

    .modal_content {
      max-width: 500px;
      margin: 10vh auto;
      background: white;
      padding: 30px;
      border-radius: 5px;
    }
    ```

    </Solution>

19. Build the following React application:

    <Figure src="/media/products-page-activity.png">Products page.</Figure>

    <Solution>

    ```json nu fp=src/products.json
    {
      "products": [
        {
          "id": 1,
          "name": "Espresso",
          "price": 5.5,
          "summary": "Galão, grinder mocha, filter plunger pot siphon mug variety est caramelization. Galão cortado medium latte organic aroma dripper lungo extraction crema. Bar variety spoon a fair trade filter iced. To go mocha wings irish kopi-luwak acerbic doppio kopi-luwak viennese saucer aroma arabica.",
          "tags": ["black"]
        },
        {
          "id": 2,
          "name": "Latte",
          "price": 4.5,
          "summary": "Robusta id fair trade, ristretto froth sugar siphon cream. Rich cinnamon aged espresso carajillo skinny acerbic iced. Froth, blue mountain eu mug, coffee carajillo flavour cappuccino and cortado mocha. Est, blue mountain froth roast as trifecta cappuccino.",
          "tags": ["milk"]
        },
        {
          "id": 3,
          "name": "Cappuccino",
          "price": 5,
          "summary": "So robust strong, pumpkin spice carajillo extraction grounds aged flavour et acerbic. Siphon as robusta grounds seasonal chicory est extraction. Half and half arabica spoon aroma cinnamon decaffeinated qui fair trade wings. Latte mocha dark redeye percolator crema black doppio body frappuccino body saucer.",
          "tags": ["milk", "froth"]
        },
        {
          "id": 4,
          "name": "Flat white",
          "price": 4.5,
          "summary": "Sugar filter java, turkish java dripper bar saucer mocha body. Barista americano roast robusta as crema carajillo strong in milk est arabica. Brewed filter beans grinder carajillo spoon cappuccino aged cortado bar extraction skinny. To go, half and half medium eu cortado single shot flavour est java.",
          "tags": ["milk"]
        },
        {
          "id": 5,
          "name": "Americano",
          "price": 4.5,
          "summary": "Robusta id fair trade, ristretto froth sugar siphon cream. Rich cinnamon aged espresso carajillo skinny acerbic iced. Froth, blue mountain eu mug, coffee carajillo flavour cappuccino and cortado mocha. Est, blue mountain froth roast as trifecta cappuccino.",
          "tags": ["water"]
        },
        {
          "id": 6,
          "name": "Mocha",
          "price": 6,
          "summary": "Robusta id fair trade, ristretto froth sugar siphon cream. Rich cinnamon aged espresso carajillo skinny acerbic iced. Froth, blue mountain eu mug, coffee carajillo flavour cappuccino and cortado mocha. Est, blue mountain froth roast as trifecta cappuccino.",
          "tags": ["chocolate", "milk", "froth"]
        }
      ],
      "ingredients": ["black", "chocolate", "milk", "froth", "water"]
    }
    ```

    ```jsx nu fp=src/App.js
    import React, { Component } from "react"
    import "./App.css"
    import productData from "./products.json"
    import { ProductListing } from "./components/ProductListing"
    import { Tags } from "./components/Tags"

    class App extends Component {
      constructor(props) {
        super(props)
        this.state = {
          selectedTag: null,
        }
        this.handleTags = this.handleTags.bind(this)
      }
      handleTags(tagName) {
        return () => {
          this.setState({ selectedTag: tagName })
        }
      }
      render() {
        const { products, ingredients } = productData
        const { selectedTag } = this.state
        return (
          <div className="container">
            <h1>Products</h1>
            <Tags
              tags={ingredients}
              selectedTag={selectedTag}
              handleTags={this.handleTags}
            />
            <ProductListing products={products} selectedTag={selectedTag} />
          </div>
        )
      }
    }

    export default App
    ```

    ```css nu fp=src/App.css
    .container {
      max-width: 960px;
      margin: 0 auto;
      padding: 0 10%;
    }

    .center {
      text-align: center;
    }
    ```

    ```jsx nu fp=src/components/ProductListing/index.js
    import React from "react"
    import { Product } from "../Product"

    const ProductListing = props => {
      const { products, selectedTag } = props
      const filteredProduct = selectedTag
        ? products.filter(product => product.tags.includes(selectedTag))
        : products
      return (
        <div>
          {filteredProduct &&
            filteredProduct.length &&
            filteredProduct.map((product, key) => (
              <Product key={`${product.name}-${key}`} product={product} />
            ))}
        </div>
      )
    }

    export { ProductListing }
    ```

    ```jsx nu fp=src/components/Product/index.js
    import React, { Component } from "react"
    import "./styles.css"

    class Product extends Component {
      constructor(props) {
        super(props)
        this.state = {
          showDescription: false,
        }
        this.toggleDescription = this.toggleDescription.bind(this)
      }
      toggleDescription() {
        this.setState({
          showDescription: !this.state.showDescription,
        })
      }
      render() {
        const { name, price, summary } = this.props.product
        const { showDescription } = this.state
        return (
          <div className="product">
            <div className="product_header">
              <h2>{name}</h2>
              <div>
                <button onClick={this.toggleDescription}>
                  {showDescription ? "-" : "+"}
                </button>
              </div>
            </div>
            <strong>${price}</strong>
            <div>{showDescription && <p>{summary}</p>}</div>
          </div>
        )
      }
    }

    export { Product }
    ```

    ```css nu fp=src/components/Product/styles.css
    .product {
      border: solid 1px #eee;
      padding: 20px;
      margin-bottom: 5px;
    }

    .product h2 {
      margin: 0;
    }

    .product_header {
      display: flex;
      justify-content: space-between;
    }

    .product button {
      background: white;
      border: solid 1px #eee;
      padding: 5px 10px;
      font-size: 20px;
    }
    ```

    ```jsx nu fp=src/components/Tags/index.js
    import React, { Component } from "react"
    import { Tag } from "../Tag"

    class Tags extends Component {
      render() {
        const { tags, selectedTag, handleTags } = this.props
        return (
          <div>
            Select Filter
            {tags.map((tag, key) => (
              <Tag
                key={`tag${key}`}
                selectedTag={selectedTag}
                handleTags={handleTags}
              >
                {tag}
              </Tag>
            ))}
          </div>
        )
      }
    }

    export { Tags }
    ```

    ```jsx nu fp=src/components/Tag/index.js
    import React from "react"
    import "./styles.css"

    const Tag = props => (
      <button
        className={`tag ${
          props.selectedTag === props.children ? "active" : ""
        }`}
        onClick={props.handleTags(props.children)}
      >
        {props.children}
      </button>
    )

    export { Tag }
    ```

    ```css nu fp=src/components/Tag/styles.css
    .tag {
      display: inline-block;
      padding: 8px 15px;
      margin: 15px 0 15px 20px;
      background: #eaeaea;
      border-radius: 5px;
      border: solid 1px #bbb;
    }

    .tag.active {
      background: #333;
      color: white;
    }
    ```

    </Solution>

20. Write an example which uses a higher-order component.

    <Solution>

    ```jsx nu fp=src/App.js
    import React, { Component } from "react"

    class App extends Component {
      render() {
        const details = [
          {
            name: "Tiger",
            number: 3890,
            endangered: true,
            photo: "https://source.unsplash.com/Si6Obte6Bu0/400x300",
            donation: 100,
          },
          {
            name: "Brown Bear",
            number: 200000,
            endangered: false,
            photo: "https://source.unsplash.com/c8XlAc1akIU/400x300",
            donation: 10,
          },
          {
            name: "Red Panda",
            number: 10000,
            endangered: true,
            photo: "https://source.unsplash.com/2zYHKx8jtvU/400x300",
            donation: 50,
          },
        ]

        return (
          <Animal details={details}>
            <h1>Endangered Animals</h1>
          </Animal>
        )
      }
    }

    const withDonationColor = WrappedComponent => {
      return class extends Component {
        constructor(props) {
          super(props)
          this.state = { donationColor: "black" }
        }

        componentDidMount() {
          const donationAmout = this.props.detail.donation
          const donationColor = donationAmout > 50 ? "green" : "red"
          this.setState({ donationColor })
        }

        render() {
          return (
            <WrappedComponent
              {...this.props}
              donationColor={this.state.donationColor}
            />
          )
        }
      }
    }

    const AnimalDetails = props => {
      const { name, number, endangered, donation } = props.detail

      return (
        <li>
          <div>
            <p>{props.image}</p>
            <p>Animal: {name}</p>
            <p>Number: {number}</p>
            <p>Endangered: {endangered ? "Yes" : "No"}</p>
            <p style={{ color: props.donationColor }}>
              Donation amount:{" "}
              <span className="donation-color">${donation}</span>
            </p>
          </div>
        </li>
      )
    }

    const WrapperComponent = withDonationColor(AnimalDetails)

    const Animal = props => {
      const details = props.details

      return (
        <div>
          {props.children}
          <ul>
            {details.map((detail, index) => (
              <WrapperComponent
                image={<Photo path={detail.photo} title={detail.name} />}
                detail={detail}
                key={index}
              />
            ))}
          </ul>
        </div>
      )
    }

    const Photo = props => {
      return <img src={props.path} alt={props.name} />
    }

    export default App
    ```

    </Solution>
